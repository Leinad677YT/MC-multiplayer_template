{
    "condition": "any_of",
    "terms": [
        {
            "condition": "entity_scores",
            "entity": "this",
            "scores": {
                "lhitdet.is_invulnerable": 1
            }
        },
        {
            "condition": "all_of",
            "terms": [
                {
                  "condition": "entity_scores",
                  "entity": "this",
                  "scores": {
                        "lteam.current": {
                            "max": {
                                "type": "score",
                                "score": "lteam.current",
                                "target": "attacker"
                            },
                            "min": {
                                "type": "score",
                                "score": "lteam.current",
                                "target": "attacker"
                            }
                        }
                    }
                },
                {
                    "condition": "inverted",
                    "term": {
                        "condition": "entity_scores",
                        "entity": "this",
                        "scores": {
                            "lcore.entity_id": {
                                    "max": {
                                    "type": "score",
                                    "score": "lcore.entity_id",
                                    "target": "attacker"
                                },
                                "min": {
                                    "type": "score",
                                    "score": "lcore.entity_id",
                                    "target": "attacker"
                                }
                            }
                        }
                    }
                },
                {
                    "condition": "inverted",
                    "term": {
                        "condition": "entity_scores",
                        "entity": "this",
                        "scores": {
                            "lplayer.id": {
                                "max": {
                                    "type": "score",
                                    "score": "lplayer.id",
                                    "target": "attacker"
                                },
                                "min": {
                                    "type": "score",
                                    "score": "lplayer.id",
                                    "target": "attacker"
                                }
                            }
                        }
                    }
                }
            ]
        }     
    ]
}